(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/login"],{4417:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(n("4795")),a=u(n("7b34"));function u(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n,r,a,u,o){try{var i=e[u](o),l=i.value}catch(c){return void n(c)}i.done?t(l):Promise.resolve(l).then(r,a)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var u=e.apply(t,n);function i(e){o(u,r,a,i,l,"next",e)}function l(e){o(u,r,a,i,l,"throw",e)}i(void 0)}))}}var l={data:function(){return{logoImgUrl:this.$baseURL+"/img/xlogo.png",TabCur:0,verifyImg:null,formData:[{placeholder:"请输入学号",label:"学号",type:"number",rules:{name:"user",value:"20181303002",verify:"req|number"}},{placeholder:"6-20个字符",label:"密码",type:"password",rules:{name:"pwd",value:"123456",verify:"req|pwd6to20",errMess:"密码格式不正确"}},{placeholder:"输入验证码",label:"验证码",type:"number",rules:{name:"captcha",value:"",verify:"req|enNum4",errMess:"验证码不正确"}}]}},onLoad:function(){this.loadValiCode()},computed:{loginType:function(){return 0==this.TabCur?"S":1==this.TabCur?"M":void 0}},methods:{tabSelect:function(e){this.TabCur=e.currentTarget.dataset.id,this.scrollLeft=60*(e.currentTarget.dataset.id-1),1==this.TabCur&&(this.formData[0].rules.value="20030083"),this.loadValiCode()},Verify:function(){var e=this;return i(r.default.mark((function t(){var n,u,o;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n={reqEmptyVal:!0},!e.$vervify({formDate:e.formData,otherPra:n})){t.next=13;break}return t.next=4,a.default.getVerCodeFlag(e.formData[2].rules.value);case 4:if(u=t.sent,u){t.next=9;break}return e.ToastFail("验证码错误"),e.loadValiCode(),t.abrupt("return",!1);case 9:return o=JSON.stringify(e.$submitForm(e.formData)),t.abrupt("return",o);case 13:return t.abrupt("return",!1);case 14:case"end":return t.stop()}}),t)})))()},doLogin:function(){var t=this;return i(r.default.mark((function n(){var u;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.Verify();case 2:if(u=n.sent,u){n.next=5;break}return n.abrupt("return");case 5:return n.next=7,a.default.doLogin(u,t.loginType).then((function(t){console.log(t),"login:ok"==t&&(e.showToast({title:"登录成功"}),e.switchTab({url:"../index/index"}))})).catch((function(e){console.log(e),t.ToastFail(e)}));case 7:case"end":return n.stop()}}),n)})))()},loadValiCode:function(){var e=this;return i(r.default.mark((function t(){return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,a.default.loadValiCode().then((function(t){e.verifyImg=wx.arrayBufferToBase64(t)})).catch((function(t){e.verifyImg=null,e.ToastFail("获取验证码失败，请重试"),console.log(t)}));case 2:case"end":return t.stop()}}),t)})))()},ToastFail:function(t){e.showToast({icon:"none",title:t})}}};t.default=l}).call(this,n("543d")["default"])},"46e9":function(e,t,n){"use strict";n.r(t);var r=n("4417"),a=n.n(r);for(var u in r)"default"!==u&&function(e){n.d(t,e,(function(){return r[e]}))}(u);t["default"]=a.a},5260:function(e,t,n){"use strict";(function(e){n("0d7f");r(n("66fd"));var t=r(n("a93d"));function r(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},"76d2":function(e,t,n){"use strict";var r,a=function(){var e=this,t=e.$createElement;e._self._c},u=[];n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return r}))},"9c15":function(e,t,n){},a371:function(e,t,n){"use strict";var r=n("9c15"),a=n.n(r);a.a},a93d:function(e,t,n){"use strict";n.r(t);var r=n("76d2"),a=n("46e9");for(var u in a)"default"!==u&&function(e){n.d(t,e,(function(){return a[e]}))}(u);n("a371");var o,i=n("f0c5"),l=Object(i["a"])(a["default"],r["b"],r["c"],!1,null,"50d8dc60",null,!1,r["a"],o);t["default"]=l.exports}},[["5260","common/runtime","common/vendor"]]]);